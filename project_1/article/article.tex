\documentclass[
    a4paper, aps, twocolumn, floatfix, superscriptaddress]{revtex4-1}

% It's nice to be able to write your own name
\usepackage[T1]{fontenc}
% Automatic clickable links
\usepackage{hyperref}
% SI-units
\usepackage{siunitx}
% Enhanced math formatting
\usepackage{amsmath}
% Extended math symbols
\usepackage{amssymb}
% Include proof environment
\usepackage{amsthm}
% Import physics package to include bra-ket
\usepackage{physics}
\usepackage{enumerate}
% Import the tensor package for tensors
\usepackage{tensor}
% Include dod and dpd fracs
\usepackage{commath}
% Include font for the identity operator
\usepackage{dsfont}
% Include package for drawing Feynman diagrams
\usepackage{tikz-feynman}
% Include package for typesetting contractions
\usepackage{simpler-wick}
% Include the Feynman-slash
\usepackage{slashed}
% Include Tikz
\usepackage{tikz}


% Macro for latin-letter vectors
\newcommand{\vf}{\mathbf}
% Macro for greek-letter vectors
\newcommand{\vfg}{\boldsymbol}

% Fast macro for real-numbers R
\newcommand{\R}{\mathbb{R}}
% Fast macro for complex-numbers C
\newcommand{\C}{\mathbb{C}}
% Fast macro for polynomial room P
\renewcommand{\P}{\mathbb{P}}
% New command for the identity operator
\newcommand{\1}{\mathds{1}}
% New command for the Lagrangian density
\newcommand{\cL}{\mathcal{L}}
% New command for the Hamiltonian density
\newcommand{\cH}{\mathcal{H}}
% Fast macro for partial differential tensors
\newcommand{\tpl}[1]{\tensor{\partial}{_#1}} % Lower
\newcommand{\tpu}[1]{\tensor{\partial}{^#1}} % Upper
% Fast macro for tensors
\newcommand{\te}[1]{\tensor{#1}}
% Fast macro for commutation and anti-commutation relations
\newcommand{\com}[2]{\left[#1, #2\right]}
\newcommand{\acom}[2]{\left\{#1, #2\right\}}

% Macros for writing auto-sized paranthesis, brackets and braces
\newcommand{\para}[1]{\left(#1\right)}
\newcommand{\brak}[1]{\left[#1\right]}
\newcommand{\brac}[1]{\left\{#1\right\}}

% Macro for creating orbital bra-ket's, i.e., bra-ket with paranthesis edges
\newcommand{\obra}[1]{( #1 \lvert}
\newcommand{\oket}[1]{\rvert #1 )}
\newcommand{\obraket}[2]{( #1 \lvert #2 )}

% Macro for expectation value
\newcommand{\expv}[1]{\langle #1 \rangle}

\newcommand{\half}{\frac{1}{2}}




\begin{document}

\title{Variational Monte Carlo on bosonic systems}
\author{Winther-Larsen, Sebastian Gregorius}
\affiliation{University of Oslo}
\author{Schøyen, Øyvind Sigmundson}
\affiliation{University of Oslo}
\date{\today}

\maketitle

\section{Introduction}
    We will in this project study the Variational Monte Carlo (VMC) method, and
    use it to evaluate the ground state energy of a trapped, hard sphere Bose
    gas.

\section{Theory}
    To model the trapped bosonic gas particles we use the potential
    \begin{align}
        V_{\text{ext}}(\vf{r})
        &=
        \begin{cases}
            \half m\omega^2r^2 & (\text{S}), \\
            \half m \bigl[
                \omega^2(x^2 + y^2) + \omega_z^2z^2
            \bigr] & (\text{E}),
        \end{cases}
    \end{align}
    where we can choose between a spherical (S) or an elliptical (E) harmonic
    trap. The two-body Hamiltonian of the system is given by
    \begin{align}
        H = \sum_{i}^{N}h(\vf{r}_i) + \sum_{i < j}^{N}w(\vf{r}_i, \vf{r}_j),
    \end{align}
    where the single particle one body operator, $h$, is given by
    \begin{align}
        h(\vf{r}_i) = -\frac{\hbar^2}{2m}\nabla_i^2
        + V_{\text{ext}}(\vf{r}_i),
    \end{align}
    (we assume equal mass)
    and the two-body interaction operator, $w$, is
    \begin{align}
        w(\vf{r}_i, \vf{r}_j)
        = \begin{cases}
            \infty & |\vf{r}_i - \vf{r}_j| \leq a, \\
            0 & |\vf{r}_i - \vf{r}_j| > a,
        \end{cases}
    \end{align}
    where $a$ is the hard sphere of the particle. The trial wavefunction we will
    be looking at is given by
    \begin{align}
        \Psi_T(\vf{r})
        &= \bra{\vf{r}}\ket{\Psi_T}
        = \prod_i^N g(\alpha, \beta, \vf{r}_i)
        \prod_{i < j}^N f(a, \vf{r}_i, \vf{r}_j),
    \end{align}
    where $\alpha$ and $\beta$ are variational parameters and
    \begin{align}
        \vf{r} = (\vf{r}_1, \vf{r}_2, \dots, \vf{r}_N, \alpha, \beta).
    \end{align}
    Here $g$ are the single-particle wavefunctions given by
    \begin{align}
        g(\alpha, \beta, \vf{r}_i)
        = \exp\bigl[
            -\alpha(x_i^2 + y_i^2 + \beta z_i^2)
        \bigr] \equiv \phi(\vf{r}_i),
    \end{align}
    and the correlation wavefunction, $f$, is
    \begin{align}
        f(a, \vf{r}_i, \vf{r}_j)
        &=
        \begin{cases}
            0 & |\vf{r}_i - \vf{r}_j| \leq a, \\
            \Bigl(
                1 - \frac{a}{|\vf{r}_i - \vf{r}_j|}
            \Bigr) & |\vf{r}_i - \vf{r}_j| > a.
        \end{cases}
    \end{align}

    \subsection{Local energy}
        As the many-body wavefunction creates a very large configuration space,
        where much of the wavefunction is small, we use the Metropolis algorithm
        in order to move towards regions in configuration space with
        ``sensible'' values. We define the \textit{local energy}, $E_L{\vf{r}}$,
        by
        \begin{align}
            E_L(\vf{r})
            &= \frac{\bra{\vf{r}}H\ket{\Psi_T}}{\bra{\vf{r}}\ket{\Psi_T}}.
        \end{align}
        If $\ket{\Psi_T}$ is an exact eigenfunction of the Hamiltonian, $E_L$
        will be constant. The closer $\ket{\Psi_T}$ is to the exact wave
        function, the less variation in $E_L$ as a function of $\vf{r}$ we get.
        One of the most computationally intensive part of the VMC algorithm will
        be to compute $E_L$. We therefore find an analytical expression for
        $E_L$ in terms of the trial wavefunction.

        \subsubsection{Non-interacting harmonic oscillator}
            We start by finding an analytical expression for $a = 0$ and $\beta
            = 1$, i.e., a non-interaction harmonic oscillator given by the
            wavefunction
            \begin{align}
                \bra{\vf{r}}\ket{\Psi_T}
                = \prod_i^N \exp\bigl[
                    -\alpha |\vf{r}_i|^2
                \bigr],
            \end{align}
            where $|\vf{r}_i| = r_i$. As $a = 0$ the interaction term,
            $w(\vf{r}_i, \vf{r}_j)$, vanishes and the Hamiltonian is given by
            (in the spherical case)
            \begin{align}
                H &= \sum_i^N h(\vf{r}_i)
                = \sum_i^N \Bigl(
                    -\frac{\hbar^2}{2m}\nabla_i^2
                    + \half m \omega^2 r_i^2
                \Bigr).
            \end{align}
            Working in spherical coordinates the gradient and the Laplace
            operator (applied to a function) becomes
            \begin{align}
                \nabla f
                &= \vf{e}_r\tpl{r}f
                + \vf{e}_{\theta}\frac{1}{r}\tpl{\theta}f
                + \vf{e}_{\phi}\frac{1}{r\sin(\theta)}\tpl{\phi}f, \\
                \nabla^2 f
                &= \frac{1}{r^2}\tpl{r}
                \bigl[
                    r^2\tpl{r}f
                \bigr]
                + \frac{1}{r^2\sin(\theta)}\tpl{\theta}
                \bigl[
                    \sin(\theta)\tpl{\theta}f
                \bigr] \nonumber\\
                &\qquad
                + \frac{1}{r^2\sin^2(\theta)}\tpl{\phi}^2f,
            \end{align}
            where $\vf{e}_r$ signifies the unit vector in the radial direction
            and we use the shorthand notation
            \begin{align}
                \tpl{r}f \equiv \dpd[]{f}{r}.
            \end{align}
            As the trial wavefunction for $\beta = 1$ is purely radial we get
            the same expression in one, two and three dimensions by setting
            \begin{align}
                r^2 =
                \begin{cases}
                    x & \text{one dimension}, \\
                    x^2 + y^2 & \text{two dimensions}, \\
                    x^2 + y^2 + z^2 & \text{three dimensions}.
                \end{cases}
            \end{align}
            The gradient then becomes
            \begin{align}
                \bra{\vf{r}}\nabla_i\ket{\Psi_T}
                &= \vf{e}_{{r_i}}\tpl{{r_i}}\prod_j^N\exp\bigl[
                    -\alpha r_j^2
                \bigr] \\
                &=
                -2\alpha r_i\prod_j^N\exp\bigl[
                    -\alpha r_j^2
                \bigr]\vf{e}_{{r_i}} \\
                &=
                -2\alpha r_i\bra{\vf{r}}\ket{\Psi_T}\vf{e}_{{r_i}}.
            \end{align}
            The Laplacian is given by
            \begin{align}
                \bra{\vf{r}}\nabla_i^2\ket{\Psi_T}
                &= \frac{1}{r_i^2}\tpl{{r_i}}
                \biggl\{
                    r_i^2\tpl{{r_i}}
                    \prod_j^N\exp\bigl[
                        -\alpha r_j^2
                    \bigr]
                \biggr\} \\
                &=
                \frac{1}{r_i^2}\tpl{{r_i}}
                \biggl\{
                    -2 \alpha r_i^3
                    \prod_j^N\exp\bigl[
                        -\alpha r_j^2
                    \bigr]
                \biggr\} \\
                &=
                \frac{1}{r_i^2}
                \Bigl\{
                    -6 \alpha r_i^2
                    + 4\alpha^2 r_i^4
                \Bigr\}
                \prod_j^N\exp\bigl[
                    -\alpha r_j^2
                \bigr]
                \\
                &=
                \Bigl\{
                    -6 \alpha
                    + 4\alpha^2 r_i^2
                \Bigr\}
                \bra{\vf{r}}\ket{\Psi_T}.
            \end{align}
            This gives the analytical expression for the local energy to be
            \begin{align}
                E_L(\vf{r})
                &= \frac{\bra{\vf{r}}H\ket{\Psi_T}}{\bra{\vf{r}}\ket{\Psi_T}} \\
                &= \sum_i^N \Bigl(
                    4\alpha^2 r_i^2
                    + \half m \omega^2 r_i^2
                \Bigr) - 6\alpha.
            \end{align}
            The \textit{drift force} of the system is given by
            \begin{align}
                \vf{F}_i
                &=
                \frac{2\bra{\vf{r}}\nabla_i\ket{\Psi_T}}
                {\bra{\vf{r}}\ket{\Psi_T}} \\
                &= -4\alpha r_i\vf{e}_{{r_i}}.
            \end{align}

        \subsubsection{The full system}
            Moving to the full system allowing $\beta$ to vary and setting $a
            \neq 0$ we write the trial wavefunction as
            \begin{align}
                \bra{\vf{r}}\ket{\Psi_T}
                &= \prod_i^N \phi(\vf{r}_i)
                \exp\Biggl(
                    \sum_{i < j}^N u(r_{ij})
                \Biggr),
            \end{align}
            where $r_{ij} = |\vf{r}_i - \vf{r}_j|$ and
            \begin{align}
                u(r_{ij}) = \ln\bigl[f(a, \vf{r}_i, \vf{r}_j)\bigr],
            \end{align}
            we wish to compute the local energy. The gradient is thus given by
            \begin{align}
                \bra{\vf{r}}\nabla_k\ket{\Psi_T}
                &= \nabla_k\brac{
                    \prod_i^N\phi(\vf{r}_i)
                    \exp\Biggl(
                        \sum_{i < j}^N u(r_{ij})
                    \Biggr)
                } \\
                &=
                \Biggl\{
                    \nabla_k
                    \prod_i^N\phi(\vf{r}_i)
                \Biggr\}
                \exp\Biggl(
                    \sum_{i < j}^N u(r_{ij})
                \Biggr) \\
                &\qquad
                +
                \prod_i^N\phi(\vf{r}_i)
                \nabla_k
                \exp\Biggl(
                    \sum_{i < j}^N u(r_{ij})
                \Biggr) \\
                &=
                \nabla_k\phi(\vf{r}_k)
                \prod_{i \neq k}^N \phi(\vf{r}_i)
                \exp\Biggl(
                    \sum_{i < j}^N u(r_{ij})
                \Biggr) \\
                &\qquad
                +
                \prod_i^N\phi(\vf{r}_i)
                \exp\Biggl(
                    \sum_{i < j}^N u(r_{ij})
                \Biggr) \\
                &\qquad
                \times
                \nabla_k
                \Biggl(
                    \sum_{i < l}^N u(r_{il})
                \Biggr).
            \end{align}
            The last term is extracted from the chain rule and can be evaluated
            as
            \begin{align}
                \nabla_k
                \Biggl(
                    \sum_{i < l}^N u(r_{il})
                \Biggr)
                &= \begin{cases}
                    \nabla_k u(r_{ik}) & i < k, \\
                    \sum_{k < l}^N \nabla_k u(r_{kl}) & i = k.
                \end{cases}
            \end{align}
            As $r_{ij} = r_{ji}$ we can rewrite the first case to
            \begin{align}
                \nabla_k u(r_{ik}) = \nabla_k u(r_{ki}).
            \end{align}
            Here $i$ varies with the product thus we get
            \begin{align}
                \nabla_k
                \Biggl(
                    \sum_{i < l}^N u(r_{il})
                \Biggr)
                &=
                \sum_{l \neq k}^N\nabla_k u(r_{kl}).
            \end{align}
            We are thus left with
            \begin{align}
                \bra{\vf{r}}\nabla_k\ket{\Psi_T}
                &=
                \nabla_k\phi(\vf{r}_k)
                \prod_{i \neq k}^N \phi(\vf{r}_i)
                \exp\Biggl(
                    \sum_{i < j}^N u(r_{ij})
                \Biggr) \\
                &\qquad
                +
                \prod_i^N\phi(\vf{r}_i)
                \exp\Biggl(
                    \sum_{i < j}^N u(r_{ij})
                \Biggr) \\
                &\qquad
                \times
                \sum_{l \neq k}^N\nabla_k u(r_{kl}).
            \end{align}



\end{document}
