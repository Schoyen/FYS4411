\documentclass[
    a4paper, aps, twocolumn, floatfix, superscriptaddress,
    nofootinbib]{revtex4-1}

% It's nice to be able to write your own name
\usepackage[T1]{fontenc}
% Automatic clickable links
\usepackage{hyperref}
% SI-units
\usepackage{siunitx}
% Enhanced math formatting
\usepackage{amsmath}
% Extended math symbols
\usepackage{amssymb}
% Include proof environment
\usepackage{amsthm}
\usepackage{enumerate}
% Import the tensor package for tensors
\usepackage{tensor}
% Include dod and dpd fracs
\usepackage{commath}
% Include font for the identity operator
\usepackage{dsfont}
% Include Tikz
\usepackage{tikz}
% Tikz add-on
\usetikzlibrary{shapes,arrows}
\usetikzlibrary{positioning}
% Several figures in the same figure
\usepackage{subfig}
% Appendix
\usepackage[toc, page]{appendix}
\usepackage{simpler-wick}

% Macro for latin-letter vectors
\newcommand{\vf}{\mathbf}
% Macro for greek-letter vectors
\newcommand{\vfg}{\boldsymbol}

% Fast macro for real-numbers R
\newcommand{\R}{\mathbb{R}}
% Fast macro for complex-numbers C
\newcommand{\C}{\mathbb{C}}
% Fast macro for polynomial room P
\renewcommand{\P}{\mathbb{P}}
% New command for the identity operator
\newcommand{\1}{\mathds{1}}
% New command for the Lagrangian density
\newcommand{\cL}{\mathcal{L}}
% New command for the Hamiltonian density
\newcommand{\cH}{\mathcal{H}}
% Fast macro for partial differential tensors
\newcommand{\tpl}[1]{\tensor{\partial}{_#1}} % Lower
\newcommand{\tpu}[1]{\tensor{\partial}{^#1}} % Upper
% Fast macro for tensors
\newcommand{\te}[1]{\tensor{#1}}
% Fast macro for commutation and anti-commutation relations
\newcommand{\com}[2]{\left[#1, #2\right]}
\newcommand{\acom}[2]{\left\{#1, #2\right\}}

% Macros for writing auto-sized paranthesis, brackets and braces
\newcommand{\para}[1]{\left(#1\right)}
\newcommand{\brak}[1]{\left[#1\right]}
\newcommand{\brac}[1]{\left\{#1\right\}}

% Macro for creating orbital bra-ket's, i.e., bra-ket with paranthesis edges
\newcommand{\obra}[1]{( #1 \lvert}
\newcommand{\oket}[1]{\rvert #1 )}
\newcommand{\obraket}[2]{( #1 \lvert #2 )}

% Macro for expectation value
\newcommand{\expv}[1]{\langle #1 \rangle}

\newcommand{\half}{\frac{1}{2}}

\newcommand{\bra}[1]{\langle #1\lvert}
\newcommand{\ket}[1]{\rvert #1\rangle}
\newcommand{\braket}[2]{\langle #1 \vert #2 \rangle}

\newcommand{\acr}[1]{a_{#1}^{\dagger}}
\newcommand{\ade}[1]{a_{#1}}

\newcommand{\kslat}{\ket{\Phi_0}}
\newcommand{\bslat}{\bra{\Phi_0}}

\newcommand{\kcc}{\ket{\Psi_{\text{CC}}}}
\newcommand{\bcc}{\bra{\Psi_{\text{CC}}}}

\newcommand{\ecc}{E_{\text{CC}}}
\newcommand{\eccd}{E_{\text{CCD}}}




\begin{document}

\title{Ground state energy of quantum dots using the coupled cluster method}
\author{Winther-Larsen, Sebastian Gregorius}
\homepage[Project code: ]{https://github.com/Schoyen/FYS4411}
\affiliation{University of Oslo}
\author{Schøyen, Øyvind Sigmundson}
\homepage[Project code: ]{https://github.com/Schoyen/FYS4411}
\affiliation{University of Oslo}
\date{\today}

\begin{abstract}
    Something about coupled-cluster... Preferably doubles.
\end{abstract}

\maketitle
\tableofcontents

% FIXME: Replace the two-body matrix elements in bra-ket notation with u-tensor.

\section{Introduction}
    %TODO: Add explanation on why the many-body problem becomes intractable.
    % This can be shown by demonstrating that the true wavefunction of the system
    % must be a linear combination of all possible Slater detemerminants built up
    % from permutations of the single particle functions in the basis. Thus the
    % energy equation becomes too large.
    In this project we will study the ground state energy of quantum dots.

\section{Theory}
    In this project we will study a system of $N$ interacting electrons. We will
    be looking at a Hamiltonian consisting of a one-body and a two-body part.
    The one-body part is given by
    \begin{align}
        h(\vf{r}_i)
        &= -\half\nabla_i^2 + \half\omega^2 \vf{r}_i^2,
    \end{align}
    where we use natural units $\hbar = c = e = 1$ and set the mass to unity.
    % Why not write $\hbar = c = e = m = 1$?
    The two-body part is the Coulomb interaction potential.
    \begin{align}
        u(\vf{r}_i, \vf{r}_j)
        &= \frac{1}{\abs{\vf{r}_i - \vf{r}_j}}.
    \end{align}
    We thus get the total Hamiltonian
    \begin{align}
        H &= h + u
        =
        \sum_{i = 1}^N h(\vf{r}_i) + \sum_{i < j}^N u(\vf{r}_i, \vf{r}_j),
    \end{align}
    where $h$ is the full one-body operator and $u$ the full two-body
    operator, i.e., over the entire system.  Working in a basis of $L$ single
    particle functions, $\{\ket{p}\}_{p = 1}^L$. We define the reference Slater
    determinant as
    \begin{align}
        \ket{\Phi_0} &\equiv \ket{1, 2, \dots, N},
    \end{align}
    i.e., a tensorproduct of the $N$ first single particle functions, $\ket{i}$,
    of the system. We call these single particle functions \emph{occupied} as
    they are contained in the Slater determinant.  We will denote the occupied
    indices with $i, j, k, l, \dots \in \{1, \dots, N\}$, the \emph{virtual}
    states with $a, b, c, d, \dots \in \{N + 1, \dots, L\}$ and general indices
    with $p, q, r, s, \dots \in \{1, \dots, L\}$. In terms of sets of basis
    functions we can write this as
    \begin{align}
        \{\ket{p}\}_{p = 1}^L
        = \{\ket{i}\}_{i = 1}^N
        \cup
        \{\ket{a}\}_{a = N + 1}^L,
    \end{align}
    i.e., the general indexed states consists of both occupied and virtual
    states. Note that the single particle functions are orthonormal, i.e.,
    \begin{align}
        \braket{p}{q} = \delta_{pq}.
    \end{align}
    We can construct other Slater determinants in this basis by exciting
    or relaxing the reference determinant. A general excitation is labeled
    $\ket{\Phi_{ij\dots}^{ab\dots}}$ which means that we have removed the single
    particle functions with indices $i, j, \dots$ from the reference and added
    $a, b, \dots$. Note that
    \begin{align}
        \braket{\Phi^{ab\dots}_{ij\dots}}{\Phi_0} = 0,
        \label{eq:excited_overlap}
    \end{align}
    for any excitation.

    \subsection{Second quantization}
        Employing the creation operators, $\acr{p}$, and the destruction
        operators, $\ade{p}$, we can write the Hamiltonian as
        \begin{align}
            H
            &=
            \sum_{pq}h_{q}^{p}\acr{p}\ade{q}
            + \frac{1}{4}\sum_{pqrs}\bra{pq}\ket{rs}\acr{p}\acr{q}\ade{s}\ade{r},
        \end{align}
        where the sums are general indices over all $L$ basis states and the
        matrix elements are defined as
        \begin{gather}
            h^{p}_{q} \equiv \bra{p}h\ket{q}, \\
            \bra{pq}\ket{rs} \equiv \bra{pq}u\ket{rs} - \bra{pq}u\ket{sr}.
        \end{gather}
        Note that we use the chemists notation to label the antisymmetric matrix
        elements.

    \subsection{The coupled cluster approximation}
        We approximate the true wavefunction, $\ket{\Psi}$, of the system by the
        coupled cluster wavefunction, $\ket{\Psi_{\text{CC}}}$, defined by
        \begin{align}
            \ket{\Psi_{\text{CC}}}
            &\equiv e^{T}\ket{\Phi_0}
            = \para{
                \sum_{i = 0}^n
                \frac{1}{n!}T^n
            }\ket{\Phi_0},
        \end{align}
        where the \emph{cluster operator}, $T$, is given by a sum of
        $p$-excitation operators labeled $T_p$. They consist of \emph{cluster
        amplitudes}, $t_{i\dots}^{a\dots}$, and creation and annihilation
        operators.
        \begin{align}
            T &= T_1 + T_2 + \dots + T_p \\
            &=
            \sum_{ia}t_i^a\acr{a}\ade{i}
            + \para{\frac{1}{2!}}^2\sum_{ijab}
            t_{ij}^{ab}\acr{a}\acr{b}\ade{i}\ade{j}
            + \dots.
        \end{align}
        In the doubles approximation we limit the cluster operator to
        \begin{align}
            T \equiv T_2
            = \frac{1}{4}\sum_{ijab}t_{ij}^{ab}\acr{a}\acr{b}\ade{j}\ade{i}.
            \label{eq:T_2}
        \end{align}
        The first part of the coupled cluster method consists of constructing
        the cluster amplitudes using the \emph{amplitude equations}. After we
        have found the amplitudes we can compute the energy.

    \subsection{Energy of the coupled cluster approximation}
        When we're going to compute the energy of a system using the coupled
        cluster approximation we would ideally want to find the expectation
        value of the energy using the coupled cluster wavefunction.
        \begin{align}
            \ecc = \bcc H\kcc.
        \end{align}
        As it turns out, this is an uncomfortable way of finding the energy
        as $T \neq T^{\dagger}$. Instead we will define what we call the
        \emph{similarity transformed Hamiltonian}. We plug the coupled
        cluster wavefunction into the Schrödinger equation.
        \begin{align}
            H\kcc = \ecc\kcc.
        \end{align}
        Next, we left multiply with the inverse of the cluster expansion,
        i.e.,
        \begin{align}
            e^{-T}H\kcc = e^{-T}\ecc\kcc
            = \ecc \kslat.
            \label{eq:clean_schrodinger}
        \end{align}
        Projecting this equation on the reference state we get
        \begin{align}
            \ecc = \bslat e^{-T}H\kcc
            = \bslat e^{-T}He^{T}\kslat,
        \end{align}
        where in the latter inner-product we have located the similarity
        transformed Hamiltonian defined by
        \begin{align}
            \bar{H} \equiv e^{-T}He^{T}.
            \label{eq:similarity_transformed_hamiltonian}
        \end{align}

        To simplify the energy equation and the amplitude equations we use the
        normal ordered Hamiltonian.
        \begin{align}
            H = H_N + \bslat H\kslat.
        \end{align}
        The energy equation thus becomes
        \begin{align}
            \ecc &= \bslat\bar{H}\kslat
            = E_0 + \bslat e^{-T}H_N e^T\kslat,
        \end{align}
        where the reference energy is given by
        \begin{align}
            E_0 = \bslat H\kslat.
        \end{align}
        We now define the normal ordered similiarity transformed Hamiltonian as
        \begin{align}
            \bar{H}_N \equiv e^{-T}H_N e^T.
        \end{align}
        By expanding the exponentials of this Hamiltonian and recognizing the
        commutators we get the Baker-Campbell-Hausdorff expansion.
        \begin{align}
            \bar{H}_N
            &=
            H_N + \com{H_N}{T} + \frac{1}{2!}\com{\com{H_N}{T}}{T} + \dots.
        \end{align}
        From the connected cluster theorem we know that the only nonzero terms
        in the Baker-Campbell-Hausdorff expansion will be the terms where the
        normal ordered Hamiltonian has at least one contraction\footnote{In the
        Wick's theorem sense.} with every cluster operator on its right. This
        lets us write the expansion as
        \begin{align}
            \bar{H}_N
            &=
            H_N + \para{H_N T}_c + \frac{1}{2!}\para{H_N T^2}_c + \dots,
            \label{eq:sim_norm_hamiltionian_expansion}
        \end{align}
        where the subscript $c$ signifies that only contributions where at least
        one contraction between $H_N$ and $T$ has been performed will be
        included.

        \subsubsection{Coupled cluster doubles energy equation}
            Using the doubles approximation with the cluster operator $T_2$
            defined in \autoref{eq:T_2} the energy equation becomes
            \begin{align}
                \eccd
                &=
                E_0
                + \bslat e^{-T_2}H_N e^{T_2}\kslat.
            \end{align}
            As the doubles cluster operator doubly excites the reference and
            using the expansion in \autoref{eq:sim_norm_hamiltionian_expansion}
            we see that we can write the energy equation as
            \begin{align}
                \eccd
                &=
                E_0
                + \bslat H_N \kslat + \bslat (H_N T_2)_c\kslat,
            \end{align}
            as the Hamiltonian is only able to relax one pair of single
            particle functions. By construction we have that
            \begin{align}
                \bslat H_N \kslat = 0.
            \end{align}
            In the second term only the normal ordered two-body operator can
            contribute as the cluster operator gives a total excitation of $+2$.
            As we are projecting onto the reference we have to relax to zero
            again. The normal ordered Fock operator is at most able to excite
            and relax by $1$ and does therefore not contribute to the
            overall expression.
            \begin{align}
                \bslat (W_N T_2)_c \kslat
                &= \frac{1}{4}\sum_{ijab}\bra{ij}\ket{ab}t_{ij}^{ab}.
            \end{align}
            In total the energy equation reduces to
            \begin{align}
                \eccd
                &= \sum_{i} h_i^i + \half \sum_{ij}\bra{ij}\ket{ij}
                + \frac{1}{4}\sum_{ijab}\bra{ij}\ket{ab}t_{ij}^{ab},
            \end{align}
            where the first two terms come from the reference energy as shown in
            \autoref{eq:reference_energy}.

    \subsection{Coupled cluster amplitude equations}
        In order for us to solve the energy equation using the coupled cluster
        approximation we need to figure out what the cluster amplitudes,
        $t_{ij\dots}^{ab\dots}$, are. This is done by projecting
        \autoref{eq:clean_schrodinger} onto an excited Slater determinant, i.e.,
        \begin{align}
            \bra{\Phi_{ij\dots}^{ab\dots}}e^{-T}He^{T}\kslat
            = 0.
        \end{align}
        Note that in the amplitude equations we can use both the regular and the
        normal ordered Hamiltonian. They are equal as the reference energy term
        disappears due to \autoref{eq:excited_overlap}. The order of the
        excitation in the projection determines the order of the amplitudes you
        will find. In our case we are only interested in the second order
        ampltiudes found in the doubles approximation, hence we will solve the
        equation
        \begin{align}
            \bra{\Phi_{ij}^{ab}}e^{-T}H_N e^{T}\kslat = 0,
            \label{eq:doubles_amplitude_1}
        \end{align}
        to find an expression that can be used to solve for $t_{ij}^{ab}$.
        By employing the Baker-Campbell-Haussdorf (BCH) expansion,
        while setting $T= T_2$, we find
        \begin{equation}
        \begin{aligned}
        		\bar{H} 
        			=& \Big(
        					H_N + H_NT_2 
        					+ \frac{1}{2}H_NT_2^2 \\
        				  	&\ + \frac{1}{6}H_NT_2^3 
        				   + \frac{1}{24} H_NT_2^4
        				 \Big)_C.
        \end{aligned}
        \label{eq:normal_order_expansion}
        \end{equation}
		The subscript $c$ indicates that only those terms in which the 
		Hamiltonian is connected\footnote{In a Wick's theorem sense}
		to every cluster operator on its right should be included. Since
		the Hamiltonian contains at most four annihilation and creation 
		operators, $H_N$ can connect to at most four cluster operators
		at once. Therefor, the BCH expansion must truncate at the
		fourth-order terms. 
		
		Now comes the rather tedious task of evaluating all the terms 
		that arises from inserting \autoref{eq:normal_order_expansion}
		into \autoref{eq:doubles_amplitude_1}. The first of such terms
		is
		\begin{equation}
		\begin{aligned}
			\bra{\Phi_{ij}^{ab}} &(F_N + V_N)\ket{\Phi_0} \\
			 =& \sum_{pq}f_{pq}\bra{\Phi_0}\{a_i^\dagger a_j^\dagger a_ba_a\}\{a^\dagger_pa_q\}\ket{\Phi_0} \\
			 &+\frac{1}{4}\sum_{pqrs}\bra{pq}\ket{rs}
			 \bra{\Phi_0}\{a_i^\dagger a_j^\dagger a_ba_a\}\{a^\dagger_pa^\dagger_qa_sa_r\}\ket{\Phi_0}.
		\end{aligned}
		\end{equation}
		The one-electron component does not have any full contractions, while the
		two-electron component produces one contributing integral,
		\begin{equation}
		\begin{aligned}
			\bra{\Phi_{ij}^{ab}} &(V_N)\ket{\Phi_0} \\
				=& \frac{1}{4}\sum_{pqrs}\bra{pq}\ket{rs}
			 \bra{\Phi_0}\{a_i^\dagger a_j^\dagger a_ba_a\}\{a^\dagger_pa^\dagger_qa_sa_r\}\ket{\Phi_0} \\
			 	=& \frac{1}{4} \sum_{pqrs} \bra{pq}\ket{rs} \\ &\times\Big(
			 		\{ \wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a
			 		\c4 a^\dagger_p \c3 a^\dagger_q \c2 a_s \c1 a_r}\}
			 		+
			 		\{ \wick{\c1 a^\dagger_i \c2 a^\dagger_j \c4 a_b \c3 a_a
			 		\c4 a^\dagger_p \c3 a^\dagger_q \c2 a_s \c1 a_r}\} \\
			 	  &\ +
			 	 	\{ \wick{\c2 a^\dagger_i \c1 a^\dagger_j \c3 a_b \c4 a_a
			 		\c4 a^\dagger_p \c3 a^\dagger_q \c2 a_s \c1 a_r}\}
			 		+
			 		\{ \wick{\c2 a^\dagger_i \c1 a^\dagger_j \c4 a_b \c3 a_a
			 		\c4 a^\dagger_p \c3 a^\dagger_q \c2 a_s \c1 a_r}\}
			 	\Big) \\
			 	=&  \frac{1}{4} \sum_{pqrs} \bra{pq}\ket{rs} 
			 	( \delta_{ap}\delta_{bq}\delta_{js}\delta_{ir}
			 	 -\delta_{aq}\delta_{bp}\delta_{js}\delta_{ir} \\
			     &\ -\delta_{ap}\delta_{bq}\delta_{jr}\delta_{is}
			 	 +\delta_{aq}\delta_{bp}\delta_{jr}\delta_{is}) \\
			 	 =& \bra{ab}\ket{ij} = u^{ab}_{ij}.
		\end{aligned}
		\end{equation}
		
		Next we would like to evaluate $\bra{\Phi_{ij}^{ab}}(F_N + V_N)T_2\ket{\Phi_0}$. Starting with the 
		term involving the Fock operator $F_N$,
		\begin{equation}
		\begin{aligned}
			\bra{\Phi_{ij}^{ab}}&F_NT_2\ket{\Phi_0} \\
				=& \frac{1}{4}\sum_{pq}\sum_{klcd}f_{pq}t_{kl}^{cd} \bra{\Phi_0}
					\{a_i^\dagger a_j^\dagger a_b a_a \}(\{a^\dagger_pa_q \}\{a^\dagger_c a^\dagger_d a_l a_k \})_c \ket{\Phi_0} \\
				=& \frac{1}{4}\sum_{pq}\sum_{klcd}f_{pq} t_{kl}^{cd} \\
				\times \Big(
					&\{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c5 a^\dagger_p \c2 a_q \c3 a^\dagger_c \c4 a^\dagger_d \c1 a_l \c5 a_k } \}
				 + \{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c5 a^\dagger_p \c1 a_q \c3 a^\dagger_c \c4 a^\dagger_d \c2 a_l \c5 a_k } \}	\\
			    + &\{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c5 a^\dagger_p \c2 a_q \c4 a^\dagger_c \c3 a^\dagger_d \c1 a_l \c5 a_k } \}
				 + \{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c5 a^\dagger_p \c1 a_q \c4 a^\dagger_c \c3 a^\dagger_d \c2 a_l \c5 a_k } \} \\
		        + &\{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c5 a^\dagger_p \c1 a_q \c3 a^\dagger_c \c4 a^\dagger_d \c5 a_l \c2 a_k } \}
		          + \{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c5 a^\dagger_p \c1 a_q \c4 a^\dagger_c \c3 a^\dagger_d \c5 a_l \c2 a_k } \} \\
		        + &\{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c5 a^\dagger_p \c2 a_q \c3 a^\dagger_c \c4 a^\dagger_d \c5 a_l \c1 a_k } \}
		          + \{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c5 a^\dagger_p \c2 a_q \c4 a^\dagger_c \c3 a^\dagger_d \c5 a_l \c1 a_k } \} \\
		        + &\{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c3 a^\dagger_p \c5 a_q \c5 a^\dagger_c \c4 a^\dagger_d \c2 a_l \c1 a_k } \}
		     	 + \{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c3 a^\dagger_p \c5 a_q \c5 a^\dagger_c \c4 a^\dagger_d \c1 a_l \c2 a_k } \} \\
		        + &\{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c4 a^\dagger_p \c5 a_q \c5 a^\dagger_c \c3 a^\dagger_d \c2 a_l \c1 a_k } \}
		          +\{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c4 a^\dagger_p \c5 a_q \c5 a^\dagger_c \c3 a^\dagger_d \c1 a_l \c2 a_k } \} \\
		        + &\{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c3 a^\dagger_p \c5 a_q \c4 a^\dagger_c \c5 a^\dagger_d \c1 a_l \c2 a_k } \}
		          +\{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c3 a^\dagger_p \c5 a_q \c4 a^\dagger_c \c5 a^\dagger_d \c2 a_l \c1 a_k } \} \\
		        + &\{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c3 a^\dagger_p \c5 a_q \c4 a^\dagger_c \c5 a^\dagger_d \c1 a_l \c2 a_k } \}
		          + \{\wick{\c1 a^\dagger_i \c2 a^\dagger_j \c3 a_b \c4 a_a \c4 a^\dagger_p \c5 a_q \c3 a^\dagger_c \c5 a^\dagger_d \c2 a_l \c1 a_k } \}
				\Big) \\
				=& \sum_{pq}\sum_{klcd}f_{pq} t_{kl}^{cd} \\
				\times&( - \delta_{a c} \delta_{b d} \delta_{i k} \delta_{j q} \delta_{l p} + \delta_{a c} \delta_{b d} \delta_{i l} \delta_{j q} \delta_{k p}  \\
				 \ &+ \delta_{a c} \delta_{b d} \delta_{i q} \delta_{j k} \delta_{l p} - \delta_{a c} \delta_{b d} \delta_{i q} \delta_{j l} \delta_{k p} \\
				 \ &+ \delta_{a c} \delta_{b p} \delta_{d q} \delta_{i k} \delta_{j l} - \delta_{a c} \delta_{b p} \delta_{d q} \delta_{i l} \delta_{j k} \\
				 \ & + \delta_{a d} \delta_{b c} \delta_{i k} \delta_{j q} \delta_{l p} - \delta_{a d} \delta_{b c} \delta_{i l} \delta_{j q} \delta_{k p} \\
				 \ &- \delta_{a d} \delta_{b c} \delta_{i q} \delta_{j k} \delta_{l p} + \delta_{a d} \delta_{b c} \delta_{i q} \delta_{j l} \delta_{k p} \\
				 \ &- \delta_{a d} \delta_{b p} \delta_{c q} \delta_{i k} \delta_{j l} + \delta_{a d} \delta_{b p} \delta_{c q} \delta_{i l} \delta_{j k} \\
				 \ &- \delta_{a p} \delta_{b c} \delta_{d q} \delta_{i k} \delta_{j l} + \delta_{a p} \delta_{b c} \delta_{d q} \delta_{i l} \delta_{j k} \\
				 \ &+ \delta_{a p} \delta_{b d} \delta_{c q} \delta_{i k} \delta_{j l} - \delta_{a p} \delta_{b d} \delta_{c q} \delta_{i l} \delta_{j k}) \\
				 =& (f_{bc}t^{ac}_{ij} - f_{ac}t^{bc}_{ij}) - (f_{jk}t^{ab}_{ik} - f_{ik}t^{ab}_{jk}) \\
				 =& f_{bc}t^{ac}_{ij}P(ab) - f_{kj}t^{ab}_{ik} \\
				 =& u_{cm}^{bm}t_{ij}^{ac}P(ab) + u_{jm}^{mk}t_{ik}^{ab}P(ij)
		\end{aligned}
		\end{equation}		
		Where in the last steps we have consigned the sums by Einstein summation notation.
		We have also only included the two-body part of the fock operator, because we are
		dealing with double excitations (relaxations) only.
		
		One could of course continue in this manner, employing Wick's general theorem to all
		terms that arises from combining \autoref{eq:normal_order_expansion}
		\autoref{eq:doubles_amplitude_1}, but because this task is quite strenuous, we employ
		the second quantisation library from SymPy instead\footnote{This is also more in the
		spirit of this project, as it is in the realm of \emph{Computational} Physics.}.
		The CCD amplitude equation, from SymPy computation, is 
		\begin{equation}
		\begin{aligned}
			0 =& u^{ab}_{ij} + t^{ac}_{ij} u^{bm}_{cm} P(ab) + t^{ab}_{ik} u^{mk}_{jsm} P(ij) \\
				 +& \frac{1}{4}t^{cd}_{ij} t^{ab}_{nm} u^{nm}_{cd} + \frac{1}{2}t^{cd}_{ij} u^{ab}_{cd} \\
				 -& \frac{1}{2}t^{cd}_{jm} t^{ab}_{in} u^{nm}_{cd} P(ij) - \frac{1}{2}t^{ac}_{nm} t^{bd}_{ij} u^{nm}_{cd} P(ab) \\
				 -& t^{ac}_{im} t^{bd}_{jn} u^{nm}_{cd} P(ij) + t^{ac}_{im} u^{bm}_{jc} P(ab) P(ij) \\
				 +& \frac{1}{2}t^{ab}_{nm} u^{nm}_{ij}, 
		\end{aligned}
		\end{equation}
		
		where we recognize the first three terms. 
		
    \subsection{Constructing the matrix elements}
        Having found the equations needed in order to find an estimate to the
        ground state energy using the coupled cluster doubles approximation is a
        well and dandy. But, we need basis functions to create the matrix
        elements needed to feed into the coupled cluster code.  Often these
        basis functions are not known and we have to use an approximation or
        utilize Hartree-Fock to create more optimized basis functions.

        \subsubsection{Harmonic oscillator basis}
            We will be looking at a system of two-dimensional quantum dots with
            a Coulomb repulsion.  If we assume, or make it so, that the
            repulsive two-body part is small we can use eigenfunctions of the
            one-body part our basis. In this case we have two-dimensional
            harmonic oscillator functions as eigenfunctions. We can then compute
            the matrix elements, $h_q^p$ and $u_{rs}^{pq}$, before feeding these
            into the coupled cluster code.

            In polar coordinates we can write the harmonic oscillator
            wavefunction for a single particle in two dimensions
            as\footnote{Note that this is without spin. As we are looking at
            fermions this means that each mode of the harmonic oscillator
            functions will be repeated twice.}.
            \begin{align}
                \phi_{nm}(r, \theta)
                &=
                N_{nm}
                (ar)^{\abs{m}}L_n^{\abs{m}}(a^2 r^2)e^{-a^2 r^2/2}
                e^{im\theta},
            \end{align}
            where $a = \sqrt{m\omega/\hbar}$ is the Bohr radius, $L_n^{\abs{m}}$
            is the associated Laguerre polynomials, $n$ and $m$ are the
            principal and azimuthal quantum numbers respectively and $N_{nm}$ is
            a normalization constant given by
            \begin{align}
                N_{nm}
                &= a\sqrt{\frac{n!}{\pi(n + \abs{m})!}}.
            \end{align}
            Included is also the spin, $\sigma$, of the wavefunction, which can
            be either up or down. This means each level, $(n, m)$, is doubly
            occupied. We also have that the wavefunctions are orthonormal
            \begin{align}
                \braket{n_1m_1\sigma_1}{n_2m_2\sigma_2}
                = \delta_{n_1n_2}\delta_{m_1m_2}\delta_{\sigma_1\sigma_2}.
            \end{align}
            The eigenenergy of a single harmonic oscillator is given by
            \begin{align}
                \epsilon_{nm} &= \hbar\omega(2n + \abs{m} + 1).
            \end{align}
            Our next job is now to create a mapping from the three quantum
            numbers $n$, $m$ and $\sigma$ to a single quantum number $\alpha$ as
            the matrices $h$ and $u$ use single indices for each wavefunction.
            In \autoref{fig:basis_states} we can see the energy levels that
            needs to be mapped.
            \begin{figure}
                \begin{center}
                    \begin{tikzpicture}[scale=0.8]
                        \begin{scope}
                            \foreach \i in {1, 2, 3} {
                                \draw(-1, \i - 1) node[anchor=east]
                                {$\epsilon = \i$};
                            }

                            % Highest energy level
                            \foreach \i in {0, 3, 6} {
                                \draw (\i, 2) -- (\i + 2, 2);
                                \node at (\i + 0.75, 2) {$\uparrow$};
                                \node at (\i + 1.25, 2) {$\downarrow$};
                            }
                            \node[below, inner sep=.2cm] at (1, 2)
                            {$n = 0, m = -2$};
                            \node[below, inner sep=.2cm] at (4, 2)
                            {$n = 1, m = 0$};
                            \node[below, inner sep=.2cm] at (7, 2)
                            {$n = 0, m = 2$};

                            % Middle energy level
                            \foreach \i in {1.5, 4.5} {
                                \draw (\i, 1) -- (\i + 2, 1);
                                \node at (\i + 0.75, 1) {$\uparrow$};
                                \node at (\i + 1.25, 1) {$\downarrow$};
                            }
                            \node[below, inner sep=.2cm] at (2.5, 1)
                            {$n = 0, m = -1$};
                            \node[below, inner sep=.2cm] at (5.5, 1)
                            {$n = 0, m = 1$};

                            % Lowest energy level
                            \draw (3, 0) -- (5, 0);
                            \node at (3 + 0.75, 0) {$\uparrow$};
                            \node at (3 + 1.25, 0) {$\downarrow$};
                            \node[below, inner sep=.2cm] at (4, 0)
                            {$n = 0, m = 0$};
                        \end{scope}
                    \end{tikzpicture}
                \end{center}
                \caption{In this plot we can see the energy degeneracy of the
                lowest three energy levels in the two-dimensional quantum dot.
                Each arrow representes a spin up or a spin down state with the
                quantum numbers $n$ and $m$ as listed below.}
                \label{fig:basis_states}
            \end{figure}

            Starting from the bottom and working our way upwards from left to
            right we can label each line from $0$ to $n$ in increasing
            order. This enumeration will serve as our common quantum number
            $\alpha$\footnote{Note that we use greek letters $\alpha, \beta,
            \dots$ for the harmonic oscillator wavefunctions as opposed to latin
            letters for the general indices.}. We will only work with full
            \emph{shells}, i.e., we restrict our views to systems of $N$
            particles where $N$ will be a magic number which we get by counting
            all spin states for each energy level and the energy levels below.
            In \autoref{fig:basis_states} we can see the magic number $N \in [2,
            6, 12]$.

            The normalization condition now reads
            \begin{align}
                \braket{\alpha}{\beta}
                = \delta_{\alpha\beta}\delta_{\sigma_\alpha\sigma_\beta},
            \end{align}
            The one-body matrix will be a diagonal matrix with the eigenenergies
            of the single particle harmonic oscillator functions as elements.
            \begin{align}
                \bra{\alpha}h\ket{\beta}
                = \epsilon_{\beta}
                \delta_{\alpha\beta}\delta_{\sigma_\alpha\sigma_\beta}.
            \end{align}

            The two-body matrix elements are a little harder to work out as the
            harmonic oscillator wavefunctions are not eigenfunctions to the
            correlation operator. Luckily, from E. Anisimovas and A.  Matulis
            (Equation A2)\cite{anisimovas1998energy} we can get an analytical
            expression for the two-body matrix elements. We can then construct
            the antisymmetric two-body matrix elements in the harmonic
            oscillator basis.
            \begin{align}
                \bra{\alpha\beta}\ket{\gamma\delta}
                &= \braket{\alpha\beta}{\gamma\delta}
                - \braket{\alpha\beta}{\delta\gamma}.
            \end{align}
            As we only need to compute these once it is a good idea to save all
            non-zero values of $\bra{\alpha\beta}\ket{\gamma\delta}$ to a file.

        \subsubsection{Constructing the Hartree-Fock basis}
            Having found the matrix elements of $h$ and $u$ we can now use the
            \emph{self-consistent field iteration} method to construct $h$ and
            $u$ in a \emph{restricted Hartree-Fock} basis. This will yield a
            better estimate to the actual, unknown basis functions of the
            system.

            % See Step 3 in:
            % http://sirius.chem.vt.edu/wiki/doku.php?id=crawdad:programming:project4

\appendix
\section{The normal ordered Hamiltonian}
    When constructing the normal ordered Hamiltonian we use Wick's theorem to
    write the one-body, $h$, and the two-body, $u$, operators onto a normal
    ordered form. Specifically we define the normal ordered form in terms of the
    \emph{Fermi vacuum}\footnote{Fermi vacuum defines the reference state, i.e.,
    $\kslat$, as the vacuum.}. That is, an operator on normal ordered form
    destroys the reference Slater determinant.

    We start by writing the one-body operator, $h$, to its normal-ordered form.
    \begin{align}
        h &= \sum_{pq}h^p_q\acr{p}\ade{q}
        = \sum_{pq}h^p_q\para{
            \{\acr{p}\ade{q}\}
            + \{
                \wick{\c a_{p}^{\dagger} \c a_{q}}
            \}
        }
        \\
        &= \sum_{pq}h^p_q\{
            \acr{p}\ade{q}
        \}
        + \sum_{pq}h^p_q\delta_{p \in i}\delta_{pq}
        \\
        &= h_N + \sum_{i}h^i_i,
    \end{align}
    where we have used $\delta_{p \in i}$ to mean that $p$ must be an occupied
    index. Doing the same for the two-body operator is a slightly more tedious
    endeavor. For brevity we will only write out the operator strings and only
    keep the non-zero contributions.
    \begin{align}
        \acr{p}\acr{q}\ade{s}\ade{r}
        &=
        \{\acr{p}\acr{q}\ade{s}\ade{r}\}
        + \{
            \wick{\c a_p^{\dagger} a_{q}^{\dagger} \c a_{s} a_{r}}
        \}
        + \{
            \wick{\c a_p^{\dagger} a_{q}^{\dagger} a_{s} \c a_{r}}
        \}
        \nonumber \\
        &\qquad
        + \{
            \wick{a_p^{\dagger} \c a_{q}^{\dagger} \c a_{s} a_{r}}
        \}
        + \{
            \wick{a_p^{\dagger} \c a_{q}^{\dagger} a_{s} \c a_{r}}
        \}
        \nonumber \\
        &\qquad
        + \{
            \wick{\c1 a_p^{\dagger} \c2 a_{q}^{\dagger} \c1 a_{s} \c2 a_{r}}
        \}
        + \{
            \wick{\c2 a_p^{\dagger} \c1 a_{q}^{\dagger} \c1 a_{s} \c2 a_{r}}
        \}
        \\
        &=
        \{\acr{p}\acr{q}\ade{s}\ade{r}\}
        - \delta_{p \in i}\delta_{ps}\{\acr{q}\ade{r}\}
        + \delta_{p \in i}\delta_{pr}\{\acr{q}\ade{s}\}
        \nonumber \\
        &\qquad
        + \delta_{q \in i}\delta_{qs}\{\acr{p}\ade{r}\}
        - \delta_{q \in i}\delta_{qr}\{\acr{p}\ade{s}\}
        \nonumber \\
        &\qquad
        - \delta_{p \in i}\delta_{ps}\delta_{q \in j}\delta_{qr}
        + \delta_{p \in i}\delta_{pr}\delta_{q \in j}\delta_{qs}.
    \end{align}
    Inserted into the full two-body operator and sorting out the sums we get
    \begin{align}
        u
        &=
        \frac{1}{4}\sum_{pqrs}\bra{pq}\ket{rs}
        \{\acr{p}\acr{q}\ade{s}\ade{r}\}
        - \frac{1}{4}\sum_{iqr}\bra{iq}\ket{ri}\{\acr{q}\ade{r}\}
        \nonumber \\
        &\qquad
        + \frac{1}{4}\sum_{iqs}\bra{iq}\ket{is}\{\acr{q}\ade{s}\}
        + \frac{1}{4}\sum_{pir}\bra{pi}\ket{ri}\{\acr{p}\ade{r}\}
        \nonumber \\
        &\qquad
        - \frac{1}{4}\sum_{pis}\bra{pi}\ket{is}\{\acr{p}\ade{s}\}
        - \frac{1}{4}\sum_{ij}\bra{ij}\ket{ji}
        \nonumber \\
        &\qquad
        + \frac{1}{4}\sum_{ij}\bra{ij}\ket{ij}.
    \end{align}
    Using the antisymmetric properties of the two-body matrix elements,
    \begin{align}
        \bra{pq}\ket{rs}
        = - \bra{pq}\ket{sr}
        = - \bra{qp}\ket{rs}
        = \bra{qp}\ket{sr},
    \end{align}
    and relabeling of the indices we can rearrange and collect some terms.
    \begin{align}
        u
        &=
        W_N + \sum_{pir}\bra{pi}\ket{ri}\{\acr{p}\ade{r}\}
        + \half\sum_{ij}\bra{ij}\ket{ij},
    \end{align}
    where the normal ordered two-body operator is
    \begin{align}
        W_N = \frac{1}{4}\sum_{pqrs}
        \bra{pq}\ket{rs}\{\acr{p}\acr{q}\ade{s}\ade{r}\}.
    \end{align}
    When we now construct the full Hamiltonian we can collect some terms. The
    constants in both the one-body and the two-body operator in total constitues
    the reference energy.
    \begin{align}
        E_0 \equiv \bslat H\kslat
        = \sum_{i}h_i^i + \frac{1}{2}\sum_{ij}\bra{ij}\ket{ij}.
        \label{eq:reference_energy}
    \end{align}
    Combining the normal ordered one-body operator and the second term in the
    two-body operator, i.e., the term with a single creation and annihilation
    operator pair, we get the normal ordered Fock-operator.
    \begin{align}
        F_N
        &=
        \sum_{pq}h_{q}^{p}\{\acr{p}\ade{q}\}
        + \sum_{pqi}\bra{pi}\ket{qi}\{\acr{p}\ade{q}\}
        \\
        &= \sum_{pq}f_{q}^{p}\{\acr{p}\ade{q}\},
    \end{align}
    where we have defined the Fock matrix elements as
    \begin{align}
        f_{q}^{p}
        &=
        h_q^p + \sum_{i}\bra{pi}\ket{qi}.
    \end{align}
    In total we get the full Hamiltonian
    \begin{align}
        H
        &=
        F_N + W_N + \bslat H\kslat
        \\
        &= H_N + \bslat H\kslat,
    \end{align}
    which is what we wanted to show.\cite{crawford2007introduction}

\section{Coupled cluster doubles diagrams}
    In order to get an expression for the energy equation and the amplitude
    equations we use a diagrammatic approach.


\bibliography{references}

\end{document}
